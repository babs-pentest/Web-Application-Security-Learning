# 2025-11-13 —  THM & Portswigger Academy — JWT Security

## What I learned:
- JSON Web Token(JWT) is a self-contained token that is used to transmit session information (Claims) securely
- Claims are pieces of information that are provided to a specific entity.
- JWT is extended by JSON Web Signature(JWS) and JSON Web Encryption(JWE):
   - **JSON Web Signature (JWS):** This is the commonly referred to as JWT.
   - **JSON Web Encryption (JWE):** This is very similar to JWS except the claims are encrypted rather than just encoded.

## Structure of JWT 
- A JWT is divided into 3 sections, each separated by a period (.).
- **The Header:** This contains metadata about the JSON Web Token known as JSON Object Signing and Encryption (JOSE).
  - Information stored in the header includes 
     - **alg:** Specifies the algorithm to sign the JWT e.g "HS256" or "RS256"
     - **typ:** Specifies the content that is being signed.
- **The Payload:** This is the body section of the JSON Web Token. It contains claims about session information.
   - example: "id": 1, "isAdmin": true
- The Signature: This is generated by the algorithm specified in the header section and used to verify the authenticity and integrity of the token.

## JWT Signing Algorithm:
- **None:** Specifies that no algorithm/signature is used (insecure and often disabled).
- **Symmetric Algorithm:** Uses a shared secret key to sign the header and payload before generating a hash value.
  - Verification is done by systems that know the secret key.
  - Examples include HMAC and HS256.
- **Asymmetric Algorithm:** Generates a hash of the header and payload and signs it with a private key.
  - Verification is done using the corresponding public key.
  - Examples include RSA and ECDSA.
  
## Securing JSON Web Token
- Lack of proper signature validation can lead to forgery.
- Always disable the none algorithm to prevent signature stripping attacks.
- Always ensure proper signature verification to prevent tampered JWTs.
- Use a strong secret key when using symmetric signing algorithms.
- In centralized authentication systems, use an audience (`aud`) claim to prevent Cross-Service Relay Attacks.
- Use short token expiry time.
- Preventing algorithm confusion attacks(RS256 -> HS256).

