# 2025-11-14 — THM — OAuth Vulnerability

## What I Learned
- OAuth is an authorization framework that enables web applications and websites to request limited access to a user's account on another platform.
- It's usually identified on the login page with "Login with", which can be any social media platform or any platform that has your information.

## OAuth Terminologies
**The Resource Owner (RO):** A system or person that has access to certain data and authorizes an app to access those data on their behalf.  
**The Client:** A mobile or web application acting as an intermediary to perform the request authorized by the resource owner.  
**The Authorization Server:** Responsible for issuing an access token to the client after successful authentication.  
**The Resource Server:** Hosts the protected resources and responds to resource requests based on the access token.  
**The State Parameter:** Maintains the state between the server and the client, ensuring that the response matches the request and protecting against CSRF.  
**The Redirect URL:** A pre-registered URL that the authorization server redirects the resource owner's user-agent to after authorization.  
**The Scope:** Helps limit the application's access to the user's account. It supports enforcing least privilege.

## Types of OAuth Grant Types
### The Authorization Code Grant
- The most secure and most popular OAuth grant type that involves the use of an authorization code for access token exchange.
- This grant type doesn't expose the access token to the browser.
- Usually used in third-party applications.

### The Implicit Grant Type
- Mostly used on web or mobile applications that can't securely store secrets.
- The flow is similar to the authorization code grant except the access token is exposed in the URL fragment.
- It is less secure compared to the authorization code grant.

### The Resource Owner Password Credential Grant
- Used when the client application is trusted by the resource owner.
- Here, the access token is granted after successfully authenticating with the client's credentials.
- Usually used on single-page applications.

### The Client Credentials Grant
- Used in server-to-server communication.
- Access token is granted after the client authenticates with its credentials without any user interaction.

## Weaknesses
- Insufficient token expiry: Access tokens with long or infinite lifetimes can pose a significant security risk.
- Token exposure in URL fragments.
- Inadequate validation of redirect URIs.
- Lack of HTTPS implementation: Leads to token interception.
- Replay attacks: Capturing valid tokens and reusing them to gain unauthorized access.

## Mitigations
- Enforce the use of HTTPS.
- Adhere to the latest framework standards.
- Deprecation of the implicit grant type due to token exposure in URL fragments.
- Implement nonce values and timestamp checks.
